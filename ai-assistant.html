<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>AI Assistant — CyberRisk Pro</title>
    <link rel="stylesheet" href="styles.css" />
</head>

<body>
    <div class="app">
        <div class="main">
            <header class="topbar">
                <button class="hamburger" onclick="toggleSidebar()"><svg viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="1.75">
                        <line x1="3" y1="12" x2="21" y2="12" />
                        <line x1="3" y1="6" x2="21" y2="6" />
                        <line x1="3" y1="18" x2="21" y2="18" />
                    </svg></button>
                <div class="page-header">
                    <div class="page-title">AI Assistant</div>
                    <div class="breadcrumb"><span>Tools</span><span class="bc-sep">/</span><span class="bc-cur">AI
                            Assistant</span></div>
                </div>
                <div class="topbar-actions">
                    <button class="btn btn-ghost btn-sm" onclick="clearChat()">Clear Chat</button>
                </div>
            </header>
            <main class="page">
                <div class="g2">

                    <!-- Chat -->
                    <div class="card flex-col" style="display:flex">
                        <div class="card-hd">
                            <div>
                                <div class="card-label mb-0">Assistant</div>
                                <div class="flex items-center gap-2 mt-1">
                                    <div style="width:6px;height:6px;border-radius:50%;background:var(--green)"></div>
                                    <span class="text-xs text-t3">Online &middot; OCTAVE Allegro Knowledge Base</span>
                                </div>
                            </div>
                        </div>
                        <div class="chat-wrap">
                            <div class="chat-msgs" id="msgs">
                                <div class="bubble ai">
                                    <span class="ai-tag">Assistant</span>
                                    Welcome. I can assist with vulnerability analysis, risk scoring, OCTAVE Allegro
                                    methodology, and ISO 27001 controls. Select a topic below or type your question.
                                </div>
                            </div>
                            <div class="quick-btns">
                                <button class="qbtn" onclick="sendQ(this)">Explain SQL Injection</button>
                                <button class="qbtn" onclick="sendQ(this)">Risk score calculation</button>
                                <button class="qbtn" onclick="sendQ(this)">OCTAVE Allegro steps</button>
                                <button class="qbtn" onclick="sendQ(this)">XSS mitigation</button>
                                <button class="qbtn" onclick="sendQ(this)">ISO 27001 controls</button>
                                <button class="qbtn" onclick="sendQ(this)">CIA triad explained</button>
                            </div>
                            <div class="chat-input-row">
                                <input class="form-control" id="chatIn"
                                    placeholder="Ask about vulnerabilities, risks, or OCTAVE steps…"
                                    onkeydown="if(event.key==='Enter')send()" />
                                <button class="btn btn-primary" onclick="send()">Send</button>
                            </div>
                        </div>
                    </div>

                    <!-- Knowledge Base -->
                    <div class="card">
                        <div class="card-label">Knowledge Base</div>
                        <div style="display:flex;flex-direction:column;gap:8px">
                            <div class="insight-row" style="cursor:pointer"
                                onclick="sendPre('Explain the OCTAVE Allegro methodology, its 8 steps, and how it compares to other risk frameworks')">
                                <span class="insight-severity tip">Guide</span>
                                <div class="insight-text"><strong>OCTAVE Allegro (8 Steps)</strong><br>Complete risk
                                    assessment methodology underpinning this platform.</div>
                            </div>
                            <div class="insight-row" style="cursor:pointer"
                                onclick="sendPre('List the OWASP Top 10 vulnerabilities for 2021 with descriptions and mitigations')">
                                <span class="insight-severity warn">Threats</span>
                                <div class="insight-text"><strong>OWASP Top 10</strong><br>Most critical web application
                                    security risks and their mitigations.</div>
                            </div>
                            <div class="insight-row" style="cursor:pointer"
                                onclick="sendPre('Explain the CIA triad with practical examples for each component')">
                                <span class="insight-severity tip">Concept</span>
                                <div class="insight-text"><strong>CIA Triad</strong><br>Confidentiality, Integrity, and
                                    Availability foundational principles.</div>
                            </div>
                            <div class="insight-row" style="cursor:pointer"
                                onclick="sendPre('How is the composite risk score calculated using likelihood and impact in OCTAVE Allegro?')">
                                <span class="insight-severity info">Method</span>
                                <div class="insight-text"><strong>Risk Scoring</strong><br>Likelihood &times; Impact
                                    matrix methodology and interpretation.</div>
                            </div>
                            <div class="insight-row" style="cursor:pointer"
                                onclick="sendPre('What are the key control domains in ISO 27001 and what are the requirements for each?')">
                                <span class="insight-severity info">Standard</span>
                                <div class="insight-text"><strong>ISO 27001 Controls</strong><br>Key Annex A control
                                    domains required for certification.</div>
                            </div>
                            <div class="insight-row" style="cursor:pointer"
                                onclick="sendPre('What immediate steps should be taken when a critical security finding is discovered during an audit?')">
                                <span class="insight-severity crit">Response</span>
                                <div class="insight-text"><strong>Critical Incident Response</strong><br>Immediate steps
                                    when critical findings are identified.</div>
                            </div>
                        </div>
                    </div>

                </div>
            </main>
        </div>
    </div>

    <div class="modal-overlay" id="modal-overlay" onclick="if(event.target===this)closeModal()">
        <div class="modal" id="modal-body"></div>
    </div>
    <script src="sidebar.js"></script>
    <script src="app.js"></script>
    <script>
        const KB = {
            'sql|injection':
                `<strong>SQL Injection</strong> allows attackers to manipulate database queries through unvalidated user input.

<strong>Risk:</strong> Authentication bypass; full data extraction; database deletion. Affected systems: login forms, search fields, API parameters.

<strong>Mitigation:</strong>
&bull; Use parameterised queries and prepared statements
&bull; Deploy a Web Application Firewall (WAF)
&bull; Apply strict server-side input validation
&bull; Enforce least-privilege database accounts
&bull; Conduct regular penetration testing`,

            'risk score|calculat|likelihood|impact':
                `<strong>Risk Score = Likelihood &times; Impact</strong> (each rated 1–5)

<strong>Score Interpretation:</strong>
&bull; 1–4 &rarr; Low
&bull; 5–9 &rarr; Medium
&bull; 10–14 &rarr; High
&bull; 15–25 &rarr; Critical

<strong>Likelihood</strong> considers threat history, attacker capability, and existing controls. <strong>Impact</strong> assesses financial, reputational, and operational effects on Confidentiality, Integrity, and Availability.`,

            'octave':
                `<strong>OCTAVE Allegro — 8 Steps:</strong>

1. Establish risk measurement criteria
2. Develop information asset profiles
3. Identify information asset containers
4. Identify areas of concern
5. Identify threat scenarios
6. Identify risks
7. Analyze risks (Likelihood &times; Impact)
8. Select mitigation approach

Focuses on operational risk from an asset-centric perspective. Designed for small teams with limited resources.`,

            'xss|cross.site|scripting':
                `<strong>Cross-Site Scripting (XSS)</strong> injects malicious scripts into pages viewed by other users.

<strong>Types:</strong> Reflected, Stored, DOM-based.

<strong>Mitigation:</strong>
&bull; Implement Content Security Policy (CSP) header
&bull; Encode all user-supplied output (HTML entity encoding)
&bull; Use HTTPOnly and Secure cookie attributes
&bull; Sanitise all inputs server-side
&bull; Avoid innerHTML — use textContent instead`,

            'iso|27001':
                `<strong>ISO 27001 Key Annex A Control Domains:</strong>

&bull; A.5 — Organisational controls
&bull; A.8 — Asset management
&bull; A.9 — Access control
&bull; A.10 — Cryptography
&bull; A.12 — Operations security (audit logging)
&bull; A.14 — System development security
&bull; A.16 — Incident management
&bull; A.17 — Business continuity

Requires an ISMS, risk assessment, Statement of Applicability, and continual improvement cycle.`,

            'cia|triad|confidential|integrit|availabilit':
                `<strong>CIA Triad — Core Security Principles:</strong>

&bull; <strong>Confidentiality</strong> — Only authorised parties access data. Controls: encryption at rest/transit, MFA, RBAC.
&bull; <strong>Integrity</strong> — Data is accurate and unaltered. Controls: hashing, digital signatures, audit logging, version control.
&bull; <strong>Availability</strong> — Systems are accessible when needed. Controls: redundancy, backups, DDoS mitigation, BCP/DR.

All security controls map to one or more CIA properties. Asset criticality scoring in this platform is based on CIA ratings.`,

            'owasp|top 10':
                `<strong>OWASP Top 10 (2021):</strong>

A01 – Broken Access Control
A02 – Cryptographic Failures
A03 – Injection (SQL, NoSQL, Command)
A04 – Insecure Design
A05 – Security Misconfiguration
A06 – Vulnerable &amp; Outdated Components
A07 – Identification &amp; Authentication Failures
A08 – Software &amp; Data Integrity Failures
A09 – Security Logging &amp; Monitoring Failures
A10 – Server-Side Request Forgery (SSRF)`,

            'critical|incident|immediate|response':
                `<strong>Critical Finding — Immediate Response Steps:</strong>

1. <strong>Contain</strong> — Isolate affected systems if actively exploited.
2. <strong>Patch</strong> — Apply fix or implement an emergency workaround.
3. <strong>Notify</strong> — Escalate to management and relevant stakeholders.
4. <strong>Preserve</strong> — Collect logs and forensic artefacts before remediation.
5. <strong>Analyse</strong> — Conduct root cause analysis to prevent recurrence.
6. <strong>Remediate</strong> — Implement permanent, tested controls.
7. <strong>Verify</strong> — Confirm remediation effectiveness via re-testing.
8. <strong>Report</strong> — Update risk register and communicate outcomes.`,
        };

        function getResp(msg) {
            const m = msg.toLowerCase();
            for (const [pattern, text] of Object.entries(KB)) {
                if (new RegExp(pattern).test(m)) return text;
            }
            return `Regarding <strong>"${msg.replace(/</g, '&lt;')}"</strong>:

Based on OCTAVE Allegro principles, I recommend reviewing the relevant threat scenarios (Step 5) for affected assets, the current likelihood and impact ratings in your risk register, and the applicable ISO 27001 controls for this threat category.

For a more specific analysis, please provide additional context or choose a topic from the Knowledge Base panel.`;
        }

        function addMsg(role, html) {
            const msgs = document.getElementById('msgs');
            const d = document.createElement('div'); d.className = `bubble ${role}`;
            d.innerHTML = role === 'ai' ? `<span class="ai-tag">Assistant</span>${html}` : html;
            msgs.appendChild(d); msgs.scrollTop = msgs.scrollHeight;
        }

        function addTyping() {
            const msgs = document.getElementById('msgs');
            const d = document.createElement('div'); d.className = 'bubble ai';
            d.innerHTML = '<span class="ai-tag">Assistant</span><div class="typing-row"><span></span><span></span><span></span></div>';
            msgs.appendChild(d); msgs.scrollTop = msgs.scrollHeight;
            return d;
        }

        function send() {
            const el = document.getElementById('chatIn'), msg = el.value.trim();
            if (!msg) return;
            addMsg('user', msg.replace(/</g, '&lt;')); el.value = '';
            const t = addTyping();
            setTimeout(() => { t.remove(); addMsg('ai', getResp(msg)); }, 900 + Math.random() * 600);
        }

        function sendQ(btn) { document.getElementById('chatIn').value = btn.textContent; send(); }
        function sendPre(msg) { document.getElementById('chatIn').value = msg; send(); }
        function clearChat() {
            document.getElementById('msgs').innerHTML = '<div class="bubble ai"><span class="ai-tag">Assistant</span>Chat cleared. How can I assist with your security assessment?</div>';
        }
    </script>
</body>

</html>